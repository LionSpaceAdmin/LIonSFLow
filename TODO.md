# LionsFlow: מפת דרכים מעודכנת לפיתוח ופריסה

## 1. חזון ומטרה

**החזון:** להפוך את LionsFlow לפלטפורמת ה-Control Plane הפנימית והמרכזית של ארגון lionsofzion-official.org. המערכת תאפשר לצוותים מורשים לבצע אוטומציה, תשאול וניהול של סביבת ה-GCP באמצעות ממשק ויזואלי בסגנון Flowise, המבוסס על תשתית מודרנית, מאובטחת וסקיילבילית של Firebase ו-Google Cloud.

**המטרה:** למנף את התשתית הקיימת (Next.js, Firebase, Genkit), לדייק את הארכיטקטורה, ולהוביל את הפרויקט משלב ה-MVP הנוכחי לפלטפורמת Production יציבה ובעלת יכולות מורחבות.

## 2. סקירת מצב קיים (Baseline Review)

בחינת קבצי הפרויקט מעלה את התמונה הבאה:

- **תשתית Frontend:** הפרויקט בנוי על Next.js 15 (App Router) עם React 19 ו-TypeScript. נעשה שימוש בספריית הקומפוננטות shadcn/ui.
- **ניהול מצב:** ניהול מצב הקנבס מתבצע באמצעות Zustand (`workflow-store.ts`).
- **Backend ו-AI:** נעשה שימוש ב-Genkit של Firebase (`@genkit-ai/next`) לניהול תהליכי AI.
- **מאגר נתונים:** Firebase Firestore נבחר כמסד הנתונים, עם חוקי אבטחה ראשוניים ב-`firestore.rules`.
- **פריסה (Deployment):** הפרויקט מוגדר לפריסה באמצעות Firebase App Hosting (`apphosting.yaml`).

### יכולות ליבה וצמתים קיימים (Built-in Nodes)
בהתבסס על `node-definitions.ts`, היכולות הבאות כבר קיימות ומוכנות לשילוב בתהליכי עבודה:
- [x] **יצירת תמונה (generate-image):** יוצר תמונה מהנחיית טקסט באמצעות Imagen 2.
- [x] **תרגום טקסט (translate-text):** מתרגם טקסט בין שפות.
- [x] **ניתוח סנטימנט (analyze-sentiment):** מזהה אם טקסט הוא חיובי, שלילי או ניטרלי.
- [x] **חילוץ ישויות (extract-entities):** מוציא נתונים מובנים (שמות, מקומות) מתוך טקסט.

## 3. מפת דרכים להמשך פיתוח

### שלב א': ביסוס וייצוב יכולות הליבה (Core Stabilization) - המיקוד הנוכחי

- [ ] **הפיכת הרצת תהליכי עבודה לאמיתית (Server-Side Execution):**
    - **המשימה:** להעביר את לוגיקת ההרצה מהדמיה בצד הלקוח (`run-workflow.ts`) להרצה אמיתית בצד השרת.
    - **המימוש:** ה-Frontend יקרא ל-API Route של Next.js, אשר יפעיל את ה-Genkit Flow המתאים בצד השרת. התוצאות והלוגים יוחזרו לקוח. **זו המשימה החשובה והראשונה ביותר.**

- [ ] **שמירה וטעינה מול Firestore:**
    - **המשימה:** לממש באופן מלא שמירה וטעינה של תהליכי עבודה מול Firestore, במקום קבצים מקומיים.
    - **המימוש:** ליצור פונקציות שישמרו את מבנה ה-ReactFlow (צמתים וחיבורים) למסמך באוסף `/users/{userId}/workflows/{workflowId}` ויטענו אותו משם.

- [x] **תצוגת לוגים:** קיים ממשק בסיסי (`logs-panel.tsx`). יש לוודא שהוא מתממשק ללוגים שחוזרים מההרצה בצד השרת.

### שלב ב': הפיכה לפלטפורמה ארגונית מרובת משתמשים

- [ ] **הטמעת Firebase Authentication מלאה:**
    - [ ] לממש באופן מלא התחברות עם Google Sign-In.
    - [ ] לנהל סשן משתמש ולהתאים את הממשק (מחובר/מנותק).
    - [ ] לממש מסכי פרופיל, הגדרות והתנתקות.
- [ ] **הקשחת אבטחה עם Firestore Security Rules:**
    - [ ] לאכוף חוקים המבטיחים שכל משתמש יכול לגשת אך ורק למידע שלו.

### שלב ג': הרחבת יכולות הניהול בארגון (Control Plane Expansion)

- [ ] **פיתוח צמתים לניהול GCP (Read-Only & Actions):**
    - [ ] לממש צמתים כפי שהוגדרו בחזון: `getIamPolicy`, `listFirewallRules`, `toggleVmInstance` וכו'. כל צומת ימומש כ-Cloud Function ייעודי או כחלק מ-Genkit Flow מרכזי.

### שלב ד': חווית משתמש ומוכנות לפרודקשן

- [ ] **שיפור חווית המשתמש (UX):** טיפול בשגיאות, הוספת אנימציות ומשוב חזותי.
- [ ] **הגדרת סביבת פריסה מלאה:** לוודא שהגדרות הפריסה תומכות ב-Backend וב-API Routes.
- [ ] **ניטור, התראות ותיעוד.**

מפת דרכים זו מוכנה כעת להתחלת הפיתוח. המיקוד המיידי הוא על **שלב א'**.